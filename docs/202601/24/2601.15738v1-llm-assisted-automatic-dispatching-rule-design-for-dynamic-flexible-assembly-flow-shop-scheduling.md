# LLM-Assisted Automatic Dispatching Rule Design for Dynamic Flexible Assembly Flow Shop Scheduling
# 大语言模型辅助的动态柔性装配流水车间调度自动派工规则设计

**Authors**: Junhao Qiu, Haoyang Zhuang, Fei Liu, Jianjun Liu, Qingfu Zhang \\
**Date**: 2026-01-22 \\
**PDF**: https://arxiv.org/pdf/2601.15738v1 \\
**Tags**: <span class="tag-label tag-blue">精读区</span> <span class="tag-label tag-pink">keyword:EOH</span> <span class="tag-label tag-pink">keyword:EAA</span> \\
**Score**: 10.0 \\
**Evidence**: LLM-assisted automatic design of heuristics for scheduling problems \\

---

## Abstract
Dynamic multi-product delivery environments demand rapid coordination of part completion and product-level kitting within hybrid processing and assembly systems to satisfy strict hierarchical supply constraints. The flexible assembly flow shop scheduling problem formally defines dependencies for multi-stage kitting, yet dynamic variants make designing integrated scheduling rules under multi-level time coupling highly challenging. Existing automated heuristic design methods, particularly genetic programming constrained to fixed terminal symbol sets, struggle to capture and leverage dynamic uncertainties and hierarchical dependency information under transient decision states. This study develops an LLM-assisted Dynamic Rule Design framework (LLM4DRD) that automatically evolves integrated online scheduling rules adapted to scheduling features. Firstly, multi-stage processing and assembly supply decisions are transformed into feasible directed edge orderings based on heterogeneous graph. Then, an elite knowledge guided initialization embeds advanced design expertise into initial rules to enhance initial quality. Additionally, a dual-expert mechanism is introduced in which LLM-A evolutionary code to generate candidate rules and LLM-S conducts scheduling evaluation, while dynamic feature-fitting rule evolution combined with hybrid evaluation enables continuous improvement and extracts adaptive rules with strong generalization capability. A series of experiments are conducted to validate the effectiveness of the method. The average tardiness of LLM4DRD is 3.17-12.39% higher than state-of-the-art methods in 20 practical instances used for training and testing, respectively. In 24 scenarios with different resource configurations, order loads, and disturbance levels totaling 480 instances, it achieves 11.10% higher performance than the second best competitor, exhibiting excellent robustness.

## 摘要
动态多产品交付

---

## 论文详细总结（自动生成）

这是一份关于论文《LLM-Assisted Automatic Dispatching Rule Design for Dynamic Flexible Assembly Flow Shop Scheduling》的结构化深入分析报告：

---

### 1. 核心问题与整体含义（研究动机与背景）
论文关注的是**动态柔性装配流水车间调度问题（FAFSP）**。在现代个性化消费背景下，制造业面临小批量定制和多产品联合交付的挑战。
*   **核心挑战**：加工（零件制作）与装配（成品组装）之间存在严格的“配套（Kitting）”约束。一个订单的交付时间取决于其中最慢的一个产品，这种多级时间耦合在动态环境（如订单随机到达、机器故障）下变得极其复杂。
*   **现有方法局限**：传统的启发式规则（PDRs）过于静态；自动设计方法（如遗传编程 GP）受限于预定义的符号集，难以捕捉复杂的动态语义和分级依赖关系。
*   **研究目标**：利用大语言模型（LLM）的逻辑推理与代码生成能力，自动演化出能够感知动态特征、协调多级供应关系的集成调度规则。

### 2. 核心方法论：LLM4DRD 框架
论文提出了 **LLM4DRD（LLM-assisted Dynamic Rule Design）** 框架，其核心思想是将调度规则的设计视为一个由 LLM 驱动的进化搜索过程。

*   **异构图建模**：将加工和装配决策统一建模为异构图上的有向边排序问题，消除不同阶段决策的冲突。
*   **双专家机制（Dual-Expert Mechanism）**：
    *   **LLM-A（算法专家）**：负责编写 Python 代码实现调度规则。
    *   **LLM-S（调度专家）**：负责分析调度结果，从语义层面指出规则的优缺点（如“过于关注当前任务而忽略了下游机器饥饿”），并提供改进建议。
*   **精英知识引导初始化**：不从零开始，而是将经典规则（如 EDD）的逻辑作为初始 Prompt 嵌入，提高搜索起点。
*   **特征拟合演化**：设计了 9 类动态状态特征（包括订单到达时间、交付期限、机器利用率、候选弧特征等），让 LLM 生成的规则函数能够根据这些实时特征动态计算优先级。
*   **混合评估策略**：结合定量指标（平均延期时间）和定性分析（LLM-S 的反馈），通过交叉、变异、定向优化和参数微调四种 Prompt 策略驱动规则演化。

### 3. 实验设计
*   **数据集**：结合了**中国某家电制造商**的真实生产数据（订单结构、资源配置）与合成数据（遵循泊松分布的订单到达）。
*   **Benchmark（对比方法）**：
    *   **传统 AHD 方法**：遗传编程（GP）、基因表达式编程（GEP）。
    *   **先进 LLM 框架**：FunSearch、EOH、MCTS-AHD、ReEvo、Random Sample。
    *   **经典规则组合**：FIFO+SPT, MOPNR+EET, LWKR+SPT 等 9 种工业常用组合。
*   **场景设置**：涵盖 24 种不同的资源规模、柔性因子、订单负载和扰动强度。

### 4. 资源与算力
*   **硬件环境**：实验在 Intel Core i5-12600KF CPU 上运行。
*   **模型使用**：主要使用了 **GPT-4o-mini** 作为核心引擎（经过对比实验发现其性价比最高）。
*   **算力消耗**：论文未明确给出总训练时长，但指出单次规则设计的 Token 消耗约为 0.33M，且生成的 PDR 规则在执行时是毫秒级的，满足在线调度需求。由于是基于 API 的启发式生成而非本地大模型训练，算力成本主要体现为 API 调用费用。

### 5. 实验数量与充分性
*   **实验规模**：
    *   **基础对比**：在 20 个代表性实例上对比了 8 种 AHD 方法。
    *   **鲁棒性测试**：在 24 种工况下进行了 480 组实验。
    *   **消融实验**：分别验证了动态特征、精英初始化、双专家机制、Prompt 策略等模块的贡献。
    *   **参数实验**：测试了不同 LLM（Qwen, Claude, DeepSeek, GPT）和采样温度的影响。
*   **充分性评价**：实验设计非常充分且客观。通过真实工业数据验证了实用性，通过大规模随机实例验证了泛化性，消融实验逻辑严密，足以支撑论文结论。

### 6. 主要结论与发现
*   **性能领先**：LLM4DRD 在平均延期指标上比现有最强 AHD 方法提升了 **3.17% - 12.39%**。
*   **鲁棒性极强**：在极端高负载和频繁扰动场景下，LLM4DRD 的表现比第二名高出 **11.10%**，且波动更小。
*   **知识进化**：证明了 LLM-S 的语义反馈能有效引导搜索跳出局部最优，实现从简单规则到复杂自适应逻辑的进化。
*   **特征敏感性**：动态特征的引入对性能提升贡献最大，证明了感知环境状态是动态调度的关键。

### 7. 论文亮点
*   **闭环反馈**：引入 LLM-S 作为“评论家”，将数值性能转化为自然语言建议，模拟了