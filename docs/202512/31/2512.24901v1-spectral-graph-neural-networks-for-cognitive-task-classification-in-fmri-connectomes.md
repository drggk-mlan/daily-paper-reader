
# Spectral Graph Neural Networks for Cognitive Task Classification in fMRI Connectomes

# 用于fMRI连接组认知任务分类的谱图神经网络



**Authors**: Debasis Maji, Arghya Banerjee, Debaditya Barman
**Date**: 2025-12-31

**Tags**: <span class="tag-label tag-green">keywords: symbolic regression</span> <span class="tag-label tag-green">keywords: transformer</span>

---

## Abstract
Cognitive task classification using machine learning plays a central role in decoding brain states from neuroimaging data. By integrating machine learning with brain network analysis, complex connectivity patterns can be extracted from functional magnetic resonance imaging connectomes. This process transforms raw blood-oxygen-level-dependent (BOLD) signals into interpretable representations of cognitive processes. Graph neural networks (GNNs) further advance this paradigm by modeling brain regions as nodes and functional connections as edges, capturing topological dependencies and multi-scale interactions that are often missed by conventional approaches. Our proposed SpectralBrainGNN model, a spectral convolution framework based on graph Fourier transforms (GFT) computed via normalized Laplacian eigendecomposition. Experiments on the Human Connectome Project-Task (HCPTask) dataset demonstrate the effectiveness of the proposed approach, achieving a classification accuracy of 96.25\%. The implementation is publicly available at https://github.com/gnnplayground/SpectralBrainGNN to support reproducibility and future research.



## 摘要
利用机器学习进行认知任务分类在从神经影像数据中解码大脑状态方面起着核心作用。通过将机器学习与脑网络分析相结合，可以从功能磁共振成像连接组中提取复杂的连接模式。这一过程将原始的血氧水平依赖（BOLD）信号转化为认知过程的可解释表示。图神经网络（GNN）进一步推进了这一范式，将脑区建模为节点，将功能连接建模为边，从而捕捉到传统方法经常遗漏的拓扑依赖关系和多尺度交互。我们提出的SpectralBrainGNN模型是一种谱卷积框架，基于通过归一化拉普拉斯特征分解计算的图傅里叶变换（GFT）。在人类连接组计划-任务（HCPTask）数据集上的实验证明了该方法的有效性，实现了96.25%的分类准确率。该实现已在 https://github.com/gnnplayground/SpectralBrainGNN 公开，以支持可复现性和未来的研究。


---

## 论文详细总结（自动生成）

### 论文总结：用于 fMRI 连接组认知任务分类的谱图神经网络

#### 1. 论文的核心问题与整体含义
*   **研究背景**：利用机器学习解读神经影像数据中的大脑状态是现代科学的核心目标之一。功能磁共振成像因其独特的时空分辨率，成为提取脑功能连接模式的重要手段。
*   **核心问题**：传统的图神经网络（GNN）方法通常在空间域聚合局部邻域信息，容易忽略大脑网络中固有的神经信号传输路径（激活通路），且可能面临过平滑的问题，难以捕捉超出成对相关性的复杂交互。
*   **整体含义**：论文提出了一种基于谱域的图神经网络模型，旨在通过捕捉频率特定的基序和多尺度交互，提高从 fMRI 连接组中解码认知任务的准确性和可解释性。

#### 2. 论文提出的方法论
*   **核心思想**：提出 **SpectralBrainGNN** 模型，这是一种基于精确图傅里叶变换的谱图神经网络。与在顶点域聚合信息的空间 GNN 不同，该方法通过归一化拉普拉斯矩阵的特征分解，在频域上进行操作，以捕获全局频率模式。
*   **流程与关键技术**：
    1.  **脑图构建**：
        *   使用 Schaefer 图谱将大脑皮层划分为感兴趣区域（ROI）作为节点。
        *   提取各 ROI 的 BOLD 信号时间序列。
        *   通过皮尔逊相关系数计算 ROI 间的功能连接，并应用阈值构建加权无向图 $G = (V, E, X)$。
    2.  **谱卷积层**：
        *   计算归一化拉普拉斯矩阵 $L = I_N - D^{-1/2}AD^{-1/2}$。
        *   进行特征分解 $L = U \Lambda U^T$，其中 $U$ 为特征向量（傅里叶基），$\Lambda$ 为特征值。
        *   **图傅里叶变换 (GFT)**：将节点特征投影到频域，$\hat{H}^{(l)} = U^T H^{(l)}$。
        *   **频域滤波**：应用可学习滤波器 $g(\lambda)$，$\hat{H}^{(l+1)} = g(\lambda) \odot \hat{H}^{(l)}$。滤波器参数通过多层感知机 (MLP) 映射特征值生成。
        *   **逆 GFT**：将过滤后的信号变换回节点域，$\tilde{H}^{(l+1)} = U \hat{H}^{(l+1)}$。
        *   最后进行线性通道混合和 ReLU 激活。
    3.  **注意力读出机制**：
        *   不使用简单的平均或最大池化，而是通过可学习的注意力向量计算每个节点的重要性权重。
        *   通过加权求和生成图级表示，强调大脑连接组中的关键功能枢纽。
    4.  **预测层**：使用全连接层和交叉熵损失进行分类。

#### 3. 实验设计
*   **数据集**：使用 **HCPTask** 数据集（源自 Human Connectome Project, HCP）。该数据集包含 7,443 个图，涵盖 7 种认知任务（情绪处理、赌博、语言理解、运动执行、关系处理、社会认知、工作记忆）。每个图包含 400 个 ROI。
*   **Benchmark 设置**：遵循 NeuroGraph 框架的标准化评估基准。
*   **对比方法**：
    *   传统 GNN：GCN, GAT, GraphSAGE。
    *   现代高级模型：ResGCN, GraphGPS, Graph-Mamba, BrainMAP。
*   **评估指标**：准确率、精确率、召回率、F1 分数。
*   **实验设置**：数据集按 60% 训练、20% 验证、20% 测试随机划分。为了结果的稳定性，实验过程重复 30 次，报告平均值和标准差。

#### 4. 资源与算力
*   **硬件**：使用了配备 **16 GB 统一内存的 Apple M4 芯片**。
*   **软件**：基于 PyTorch 框架实现。
*   **训练细节**：未明确提及 GPU 型号（仅提到 Apple M4），未提及具体的训练时长（墙钟时间），但指明模型训练了 200 个 epoch，并进行了多次重复实验以确保稳定性。

#### 5. 实验数量与充分性
*   **实验数量**：主要在 HCPTask 一个数据集上进行了 7 种基线方法的对比实验。
*   **充分性评估**：
    *   **较为充分**：论文选取了当前具有竞争力的先进基线（如 BrainMAP, Graph-Mamba），并通过 30 次重复实验和配对 t 检验（p=0.028）验证了性能提升的统计显著性。
    *   **客观性**：使用了公开的标准化 Benchmark（NeuroGraph），并严格采用相同的数据划分和训练策略，保证了对比的公平性。
    *   **深入分析**：不仅提供了数值结果，还通过混淆矩阵分析了模型在相似认知任务（如情绪与赌博任务）上的误判原因，并结合神经科学知识解释了这些错误的合理性。

#### 6. 论文的主要结论与发现
*   **性能表现**：SpectralBrainGNN 在 HCPTask 数据集上实现了 **96.25%** 的分类准确率，优于目前最先进的 BrainMAP (94.74%) 和 Graph-Mamba (94.17%)。
*   **方法有效性**：基于精确傅里叶变换的谱域能够有效捕获特定频率的连接模式，相比空间域聚合具有更强的选择性和判别力。
*   **生物学解释**：模型的误判主要集中在神经回路重叠的任务（如涉及奖赏和情绪处理的脑区），表明模型捕捉到了符合生物学规律的脑动态。

#### 7. 优点
*   **高性能**：在认知任务分类任务上取得了最新的 SOTA 结果。
*   **谱域创新**：利用精确的拉普拉斯特征分解和可学习的频率滤波器，避免了传统空间 GNN 的过平滑问题，提供了更敏锐的频率选择性。
*   **可解释性**：引入注意力读出机制，能够识别出对分类起关键作用的脑区（功能枢纽）。
*   **开源可复现**：代码已在 GitHub 公开，支持社区复现和后续研究。

#### 8. 不足与局限
*   **计算复杂度**：精确的特征分解计算复杂度为 $O(N^3)$。尽管论文提到通过缓存特征向量来分摊成本，但对于超大规模图（节点数远超 400 时），该方法仍面临显著的扩展性挑战。
*   **数据集覆盖**：实验仅在 HCP 任务态数据集上进行，缺乏在其他模态（如静息态 fMRI）或疾病诊断数据集上的泛化性验证。
*   **静态图假设**：模型处理的是静态的功能连接图，未涉及 fMRI 数据的动态时序分析（这也是作者提出的未来工作方向）。